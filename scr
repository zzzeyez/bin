#!/usr/bin/env bash
#
# author: daniel neemann (@zzzeyez)
# macos screenshot script
#
# optional dependencies: `notify-send`, `upload`

dir="$HOME/Pictures/Screenshots/$(date +'%y-%m-%d')"
file="$(date +'%H-%M-%S')"
image="$dir/$file.png"

screenshot() {
	mkdir -p "$dir"
	screencapture -i "$image"
}

notify(){
	notify-send -m "âœ” Screenshot $file.png saved" -i "$image"
}

up(){
	upload "$image"
}

case "$1" in
	-n)
	notify
	;;
	-u)
	up
	;;
	-nu|-un)
	notify && up
	;;
esac

multiple() {
	while getopts nuh opt; do
		case $opt in
			n) notify
			;;
			u) up
			;;
			h) echo "-n to notify when finished, -u to upload"
			;;
		esac
	done
}

if [ "$#" -gt 0 ]; then
	screenshot &&
	multiple
else
	screenshot
fi
